{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"C:\\\\Users\\\\jespe\\\\Documents\\\\Android-Chat\\\\components\\\\CustomActions.js\";\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport * as Permissions from 'expo-permissions';\nimport * as ImagePicker from 'expo-image-picker';\nimport * as Location from 'expo-location';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport View from \"react-native-web/dist/exports/View\";\n\nvar CustomActions = function (_React$Component) {\n  _inherits(CustomActions, _React$Component);\n\n  var _super = _createSuper(CustomActions);\n\n  function CustomActions() {\n    var _this;\n\n    _classCallCheck(this, CustomActions);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _super.call.apply(_super, [this].concat(args));\n\n    _this.getLocation = function _callee() {\n      var _await$Permissions$as, status, result, longitude, altitude;\n\n      return _regeneratorRuntime.async(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.LOCATION));\n\n            case 3:\n              _await$Permissions$as = _context.sent;\n              status = _await$Permissions$as.status;\n\n              if (!(status === \"granted\")) {\n                _context.next = 12;\n                break;\n              }\n\n              _context.next = 8;\n              return _regeneratorRuntime.awrap(Location.getCurrentPositionAsync({}).catch(function (error) {\n                return console.log(error);\n              }));\n\n            case 8:\n              result = _context.sent;\n              longitude = JSON.stringify(result.coords.longitude);\n              altitude = JSON.stringify(result.coords.latitude);\n\n              if (result) {\n                _this.props.onSend({\n                  location: {\n                    longitude: result.coords.longitude,\n                    latitude: result.coords.latitude\n                  }\n                });\n              }\n\n            case 12:\n              _context.next = 17;\n              break;\n\n            case 14:\n              _context.prev = 14;\n              _context.t0 = _context[\"catch\"](0);\n              console.log(_context.t0.message);\n\n            case 17:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, [[0, 14]], Promise);\n    };\n\n    _this.uploadImageFetch = function _callee2(uri) {\n      var blob, imageNameBefore, imageName, ref, snapshot;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return _regeneratorRuntime.awrap(new Promise(function (resolve, reject) {\n                var xhr = new XMLHttpRequest();\n\n                xhr.onload = function () {\n                  resolve(xhr.response);\n                };\n\n                xhr.onerror = function (e) {\n                  console.log(e);\n                  reject(new TypeError(\"Network request failed\"));\n                };\n\n                xhr.responseType = \"blob\";\n                xhr.open(\"GET\", uri, true);\n                xhr.send(null);\n              }));\n\n            case 2:\n              blob = _context2.sent;\n              imageNameBefore = uri.split(\"/\");\n              imageName = imageNameBefore[imageNameBefore.length - 1];\n              ref = firebase.storage().ref().child(\"images/\" + imageName);\n              _context2.next = 8;\n              return _regeneratorRuntime.awrap(ref.put(blob));\n\n            case 8:\n              snapshot = _context2.sent;\n              blob.close();\n              _context2.next = 12;\n              return _regeneratorRuntime.awrap(snapshot.ref.getDownloadURL());\n\n            case 12:\n              return _context2.abrupt(\"return\", _context2.sent);\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    return _this;\n  }\n\n  _createClass(CustomActions, [{\n    key: \"imagePicker\",\n    value: function imagePicker() {\n      var _await$Permissions$as2, status, result, imageUrl;\n\n      return _regeneratorRuntime.async(function imagePicker$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              _context3.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.MEDIA_LIBRARY));\n\n            case 2:\n              _await$Permissions$as2 = _context3.sent;\n              status = _await$Permissions$as2.status;\n              _context3.prev = 4;\n\n              if (!(status === 'granted')) {\n                _context3.next = 15;\n                break;\n              }\n\n              _context3.next = 8;\n              return _regeneratorRuntime.awrap(ImagePicker.launchImageLibraryAsync({\n                mediaTypes: 'Images'\n              }).catch(function (error) {\n                return console.log(error);\n              }));\n\n            case 8:\n              result = _context3.sent;\n\n              if (result.cancelled) {\n                _context3.next = 15;\n                break;\n              }\n\n              _context3.next = 12;\n              return _regeneratorRuntime.awrap(this.uploadImageFetch(result.uri));\n\n            case 12:\n              imageUrl = _context3.sent;\n              console.log('imgae', result.uri);\n              this.props.onSend({\n                image: imageUrl\n              });\n\n            case 15:\n              _context3.next = 20;\n              break;\n\n            case 17:\n              _context3.prev = 17;\n              _context3.t0 = _context3[\"catch\"](4);\n              console.log(_context3.t0.message);\n\n            case 20:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, null, this, [[4, 17]], Promise);\n    }\n  }, {\n    key: \"uploadImageFetch\",\n    value: function uploadImageFetch() {\n      var blob, imageNameBefore, imageName, ref, snapshot;\n      return _regeneratorRuntime.async(function uploadImageFetch$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              _context4.next = 2;\n              return _regeneratorRuntime.awrap(new Promise(function (resolve, reject) {\n                var xhr = new XMLHttpRequest();\n\n                xhr.onload = function () {\n                  resolve(xhr.response);\n                };\n\n                xhr.onerror = function (e) {\n                  console.log(e);\n                  reject(new TypeError('Network request failed'));\n                };\n\n                xhr.responseType = 'blob';\n                xhr.open('GET', uri, true);\n                xhr.send(null);\n              }));\n\n            case 2:\n              blob = _context4.sent;\n              imageNameBefore = uri.split('/');\n              imageName = imageNameBefore[imageNameBefore.length - 1];\n              ref = firebase.storage().ref().child(\"images/\" + imageName);\n              _context4.next = 8;\n              return _regeneratorRuntime.awrap(ref.put(blob));\n\n            case 8:\n              snapshot = _context4.sent;\n              blob.close();\n              _context4.next = 12;\n              return _regeneratorRuntime.awrap(snapshot.ref.getDownloadURL());\n\n            case 12:\n              return _context4.abrupt(\"return\", _context4.sent);\n\n            case 13:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }\n  }, {\n    key: \"takePhoto\",\n    value: function takePhoto() {\n      var _await$Permissions$as3, status, result, imageUrl;\n\n      return _regeneratorRuntime.async(function takePhoto$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              _context5.next = 2;\n              return _regeneratorRuntime.awrap(Permissions.askAsync(Permissions.CAMERA, Permissions.MEDIA_LIBRARY));\n\n            case 2:\n              _await$Permissions$as3 = _context5.sent;\n              status = _await$Permissions$as3.status;\n              _context5.prev = 4;\n\n              if (!(status === 'granted')) {\n                _context5.next = 14;\n                break;\n              }\n\n              _context5.next = 8;\n              return _regeneratorRuntime.awrap(ImagePicker.launchCameraAsync({\n                mediaTypes: ImagePicker.MediaTypeOptions.Images\n              }).catch(function (error) {\n                return console.log(error);\n              }));\n\n            case 8:\n              result = _context5.sent;\n\n              if (result.cancelled) {\n                _context5.next = 14;\n                break;\n              }\n\n              _context5.next = 12;\n              return _regeneratorRuntime.awrap(this.uploadImageFetch(result.uri));\n\n            case 12:\n              imageUrl = _context5.sent;\n              this.props.onSend({\n                image: imageUrl\n              });\n\n            case 14:\n              _context5.next = 19;\n              break;\n\n            case 16:\n              _context5.prev = 16;\n              _context5.t0 = _context5[\"catch\"](4);\n              console.log(_context5.t0.message);\n\n            case 19:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, null, this, [[4, 16]], Promise);\n    }\n  }, {\n    key: \"onActionPress\",\n    value: function onActionPress() {\n      var _this2 = this;\n\n      var options = ['Choose From Library', 'Take Picture', 'Send Location', 'Cancel'];\n      var cancelButtonIndex = options.length - 1;\n      this.context.actionSheet().showActionSheetWithOptions({\n        options: options,\n        cancelButtonIndex: cancelButtonIndex\n      }, function _callee3(buttonIndex) {\n        return _regeneratorRuntime.async(function _callee3$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                _context6.t0 = buttonIndex;\n                _context6.next = _context6.t0 === 0 ? 3 : _context6.t0 === 1 ? 5 : _context6.t0 === 2 ? 7 : 9;\n                break;\n\n              case 3:\n                console.log('user wants to pick an image');\n                return _context6.abrupt(\"return\", _this2.imagePicker());\n\n              case 5:\n                console.log('user wants to take a photo');\n                return _context6.abrupt(\"return\", _this2.takePhoto());\n\n              case 7:\n                console.log('user wants to get their location');\n                return _context6.abrupt(\"return\", _this2.getLocation());\n\n              case 9:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, null, null, null, Promise);\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(TouchableOpacity, {\n        style: [styles.container],\n        onPress: this.onActionPress,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 168,\n          columnNumber: 7\n        }\n      }, React.createElement(View, {\n        style: [styles.wrapper, this.props.wrapperStyle],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 169,\n          columnNumber: 9\n        }\n      }, React.createElement(Text, {\n        style: [styles.iconText, this.props.iconTextStyle],\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 11\n        }\n      }, \"+\")));\n    }\n  }]);\n\n  return CustomActions;\n}(React.Component);\n\nexport { CustomActions as default };\nvar styles = StyleSheet.create({\n  container: {\n    width: 26,\n    height: 26,\n    marginLeft: 10,\n    marginBottom: 10\n  },\n  wrapper: {\n    borderRadius: 13,\n    borderColor: 'white',\n    borderWidth: 2,\n    flex: 1,\n    backgroundColor: '#FF364E'\n  },\n  iconText: {\n    color: 'white',\n    fontWeight: 'bold',\n    fontSize: 17,\n    backgroundColor: 'transparent',\n    textAlign: 'center'\n  }\n});\nCustomActions.contextTypes = {\n  actionSheet: PropTypes.function\n};\nCustomActions.PropTypes = {\n  iconTextStyle: PropTypes.object,\n  onSend: PropTypes.function,\n  wrapperStyle: PropTypes.object\n};","map":{"version":3,"sources":["C:/Users/jespe/Documents/Android-Chat/components/CustomActions.js"],"names":["React","PropTypes","Permissions","ImagePicker","Location","CustomActions","getLocation","askAsync","LOCATION","status","getCurrentPositionAsync","catch","error","console","log","result","longitude","JSON","stringify","coords","altitude","latitude","props","onSend","location","message","uploadImageFetch","uri","Promise","resolve","reject","xhr","XMLHttpRequest","onload","response","onerror","e","TypeError","responseType","open","send","blob","imageNameBefore","split","imageName","length","ref","firebase","storage","child","put","snapshot","close","getDownloadURL","MEDIA_LIBRARY","launchImageLibraryAsync","mediaTypes","cancelled","imageUrl","image","CAMERA","launchCameraAsync","MediaTypeOptions","Images","options","cancelButtonIndex","context","actionSheet","showActionSheetWithOptions","buttonIndex","imagePicker","takePhoto","styles","container","onActionPress","wrapper","wrapperStyle","iconText","iconTextStyle","Component","StyleSheet","create","width","height","marginLeft","marginBottom","borderRadius","borderColor","borderWidth","flex","backgroundColor","color","fontWeight","fontSize","textAlign","contextTypes","function","object"],"mappings":"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","sourcesContent":["import React from 'react';\r\nimport PropTypes from 'prop-types';\r\nimport * as Permissions from 'expo-permissions';\r\nimport * as ImagePicker from 'expo-image-picker';\r\nimport * as Location from 'expo-location';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\n\r\nexport default class CustomActions extends React.Component {\r\n  // this code lets the user pick an image they want to send with permission access\r\n  async imagePicker() {\r\n    const { status } = await Permissions.askAsync(Permissions.MEDIA_LIBRARY);\r\n\r\n    try {\r\n      if(status === 'granted') {\r\n        let result = await ImagePicker.launchImageLibraryAsync({\r\n          mediaTypes: 'Images',\r\n        }).catch(error => console.log(error));\r\n\r\n        if (!result.cancelled) {\r\n          const imageUrl = await this.uploadImageFetch(result.uri);\r\n          console.log('imgae', (result.uri));\r\n          this.props.onSend({ image: imageUrl });\r\n        }  \r\n      }\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  }\r\n\r\n  // here we can upload pictures to our firebase database\r\n  async uploadImageFetch() {\r\n    const blob = await new Promise((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.onload = function() {\r\n        resolve(xhr.response);\r\n      };\r\n      xhr.onerror = function(e) {\r\n        console.log(e);\r\n        reject(new TypeError('Network request failed'));\r\n      };\r\n      xhr.responseType = 'blob';\r\n      xhr.open('GET', uri, true);\r\n      xhr.send(null);\r\n    });\r\n\r\n    const imageNameBefore = uri.split('/');\r\n    const imageName = imageNameBefore[imageNameBefore.length - 1];\r\n\r\n    const ref = firebase.storage().ref().child(`images/${imageName}`);\r\n    const snapshot = await ref.put(blob);\r\n      \r\n    blob.close();\r\n\r\n    return await snapshot.ref.getDownloadURL();\r\n  }\r\n\r\n  // take photo with the camera with asking permission\r\n  async takePhoto() {\r\n    const { status } = await Permissions.askAsync(\r\n      Permissions.CAMERA,\r\n      Permissions.MEDIA_LIBRARY,\r\n    );\r\n    try {\r\n      if (status === 'granted') {\r\n        const result = await ImagePicker.launchCameraAsync({\r\n          mediaTypes: ImagePicker.MediaTypeOptions.Images,\r\n        }).catch((error) => console.log(error));\r\n\r\n        if (!result.cancelled) {\r\n          const imageUrl = await this.uploadImageFetch(result.uri);\r\n          this.props.onSend({ image: imageUrl });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  }\r\n\r\n  // get location and ask permission through async \r\n  getLocation = async () => {\r\n    try {\r\n      const { status } = await Permissions.askAsync(Permissions.LOCATION);\r\n      if (status === \"granted\") {\r\n        const result = await Location.getCurrentPositionAsync(\r\n          {}\r\n        ).catch((error) => console.log(error));\r\n        const longitude = JSON.stringify(result.coords.longitude);\r\n        const altitude = JSON.stringify(result.coords.latitude);\r\n        if (result) {\r\n          this.props.onSend({\r\n            location: {\r\n              longitude: result.coords.longitude,\r\n              latitude: result.coords.latitude,\r\n            },\r\n          });\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.log(error.message);\r\n    }\r\n  };\r\n\r\n  /**\r\n   * Upload images to firebase\r\n   * @function uploadImageFetch\r\n   * @async\r\n   */\r\n  uploadImageFetch = async (uri) => {\r\n    const blob = await new Promise((resolve, reject) => {\r\n      const xhr = new XMLHttpRequest();\r\n      xhr.onload = function () {\r\n        resolve(xhr.response);\r\n      };\r\n      xhr.onerror = function (e) {\r\n        console.log(e);\r\n        reject(new TypeError(\"Network request failed\"));\r\n      };\r\n      xhr.responseType = \"blob\";\r\n      xhr.open(\"GET\", uri, true);\r\n      xhr.send(null);\r\n    });\r\n\r\n    const imageNameBefore = uri.split(\"/\");\r\n    const imageName = imageNameBefore[imageNameBefore.length - 1];\r\n\r\n    const ref = firebase.storage().ref().child(`images/${imageName}`);\r\n\r\n    const snapshot = await ref.put(blob);\r\n\r\n    blob.close();\r\n\r\n    return await snapshot.ref.getDownloadURL();\r\n  };\r\n\r\n\r\n  onActionPress() {\r\n    const options = [\r\n      'Choose From Library',\r\n      'Take Picture',\r\n      'Send Location',\r\n      'Cancel',\r\n    ];\r\n    const cancelButtonIndex = options.length - 1;\r\n    this.context.actionSheet()\r\n    .showActionSheetWithOptions(\r\n      {\r\n        options,\r\n        cancelButtonIndex,\r\n      },\r\n      async (buttonIndex) => {\r\n        switch (buttonIndex) {\r\n        case 0:\r\n          console.log('user wants to pick an image');\r\n          return this.imagePicker();\r\n        case 1:\r\n          console.log('user wants to take a photo');\r\n          return this.takePhoto();\r\n        case 2:\r\n          console.log('user wants to get their location');\r\n          return this.getLocation();\r\n        }\r\n      }\r\n    );\r\n  }\r\n\r\n  render() {\r\n    return(\r\n      <TouchableOpacity style={[styles.container]} onPress={this.onActionPress}>\r\n        <View style={[styles.wrapper, this.props.wrapperStyle]}>\r\n          <Text style={[styles.iconText, this.props.iconTextStyle]}>+</Text>\r\n        </View>\r\n      </TouchableOpacity>\r\n    );\r\n  }\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    width: 26,\r\n    height: 26,\r\n    marginLeft: 10,\r\n    marginBottom: 10,\r\n  },\r\n  wrapper: {\r\n    borderRadius: 13,\r\n    borderColor: 'white',\r\n    borderWidth: 2,\r\n    flex: 1,\r\n    backgroundColor: '#FF364E',\r\n  },\r\n  iconText: {\r\n    color: 'white',\r\n    fontWeight: 'bold',\r\n    fontSize: 17,\r\n    backgroundColor: 'transparent',\r\n    textAlign: 'center',\r\n  },\r\n});\r\n\r\nCustomActions.contextTypes = {\r\n  actionSheet: PropTypes.function\r\n};\r\n\r\nCustomActions.PropTypes = {\r\n  iconTextStyle: PropTypes.object,\r\n  onSend: PropTypes.function,\r\n  wrapperStyle: PropTypes.object,\r\n};"]},"metadata":{},"sourceType":"module"}